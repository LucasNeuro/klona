---
// CTA section component - Sem IA
---

<section id="contato" class="py-24 bg-black text-white">
  <div class="max-w-4xl mx-auto px-6">
    <div class="text-center mb-12">
      <h2 class="text-4xl md:text-6xl font-black mb-6 tracking-tight">
        Pronto para <span class="text-yellow-400">Economizar R$ 50.000/m√™s</span> com Nossa An√°lise?
      </h2>
      
      <p class="text-xl opacity-90 mb-12 max-w-2xl mx-auto">
        Fale com nossos especialistas e descubra como nossa an√°lise pode <span class="text-yellow-400 font-bold">economizar at√© R$ 50.000 por m√™s</span> em assinaturas e mensalidades de softwares redundantes.
        <span class="text-red-400 font-bold">Elimine dados desintegrados</span> na jornada do cliente,
        <span class="text-red-400 font-bold">reduza cancelamentos</span> e <span class="text-red-400 font-bold">aumente seu lucro</span>.
      </p>
    </div>
    
    <div class="bg-white/5 backdrop-blur-lg rounded-lg p-8 border border-white/10">
      <form id="contactForm" class="space-y-6">
        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <label for="nome" class="block text-sm font-medium mb-2">Nome Completo *</label>
            <input 
              type="text" 
              id="nome" 
              name="nome" 
              required 
              class="w-full p-4 border border-white/20 rounded-sm bg-white/5 backdrop-blur-lg text-white placeholder-white/60 focus:outline-none focus:border-primary-500 focus:bg-white/10 transition-all duration-300"
              placeholder="Seu nome completo"
            />
          </div>
          
          <div>
            <label for="email" class="block text-sm font-medium mb-2">Email *</label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              required 
              class="w-full p-4 border border-white/20 rounded-sm bg-white/5 backdrop-blur-lg text-white placeholder-white/60 focus:outline-none focus:border-primary-500 focus:bg-white/10 transition-all duration-300"
              placeholder="seu@email.com"
            />
          </div>
        </div>
        
        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <label for="telefone" class="block text-sm font-medium mb-2">Telefone/WhatsApp</label>
            <input 
              type="tel" 
              id="telefone" 
              name="telefone" 
              class="w-full p-4 border border-white/20 rounded-sm bg-white/5 backdrop-blur-lg text-white placeholder-white/60 focus:outline-none focus:border-primary-500 focus:bg-white/10 transition-all duration-300"
              placeholder="(11) 99999-9999"
            />
          </div>
          
          <div>
            <label for="empresa" class="block text-sm font-medium mb-2">Empresa *</label>
            <input 
              type="text" 
              id="empresa" 
              name="empresa" 
              required 
              class="w-full p-4 border border-white/20 rounded-sm bg-white/5 backdrop-blur-lg text-white placeholder-white/60 focus:outline-none focus:border-primary-500 focus:bg-white/10 transition-all duration-300"
              placeholder="Nome da sua empresa"
            />
          </div>
        </div>
        
        <div>
          <label for="cargo" class="block text-sm font-medium mb-2">Cargo *</label>
          <input 
            type="text" 
            id="cargo" 
            name="cargo" 
            required 
            class="w-full p-4 border border-white/20 rounded-sm bg-white/5 backdrop-blur-lg text-white placeholder-white/60 focus:outline-none focus:border-primary-500 focus:bg-white/10 transition-all duration-300"
            placeholder="CEO, CTO, Diretor, etc."
          />
        </div>
        
        <div>
          <label for="mensagem" class="block text-sm font-medium mb-2">Como podemos ajudar? (Opcional)</label>
          <textarea 
            id="mensagem" 
            name="mensagem" 
            rows="3"
            class="w-full p-4 border border-white/20 rounded-sm bg-white/5 backdrop-blur-lg text-white placeholder-white/60 focus:outline-none focus:border-primary-500 focus:bg-white/10 transition-all duration-300 resize-none"
            placeholder="Conte-nos sobre os principais desafios da sua empresa com softwares para nossa an√°lise..."
          ></textarea>
        </div>
        
        <button 
          type="submit" 
          class="w-full bg-primary-500 text-white p-5 border-none rounded-sm font-bold text-lg cursor-pointer transition-all duration-300 shadow-lg hover:-translate-y-1 hover:shadow-xl hover:bg-primary-600"
        >
          üöÄ Economizar R$ 50.000/m√™s - Agendar An√°lise Gratuita
        </button>
        
        <p class="text-sm text-white/60 text-center">
          * Campos obrigat√≥rios. Entraremos em contato em at√© 24h.
        </p>
      </form>
    </div>
  </div>
</section>

<script>
  // Fun√ß√£o para mostrar mensagem de sucesso personalizada
  function mostrarMensagemSucesso() {
    // Criar container do toast
    const toast = document.createElement('div');
    toast.className = 'fixed top-4 right-4 bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-lg shadow-2xl z-50 max-w-sm transform translate-x-full transition-all duration-500';
    toast.innerHTML = `
      <div class="flex items-start gap-3">
        <div class="flex-shrink-0">
          <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center">
            <span class="text-xl">üéâ</span>
          </div>
        </div>
        <div class="flex-1">
          <h3 class="font-bold text-lg mb-1">Obrigado pelo seu interesse!</h3>
          <p class="text-sm opacity-90 leading-relaxed">
            Recebemos sua solicita√ß√£o de an√°lise gratuita. Nossa equipe entrar√° em contato em at√© 24h para agendar sua consultoria especializada.
          </p>
        </div>
        <button onclick="this.parentElement.parentElement.remove()" class="text-white/70 hover:text-white text-xl leading-none">&times;</button>
      </div>
    `;
    
    document.body.appendChild(toast);
    
    // Animar entrada
    setTimeout(() => {
      toast.classList.remove('translate-x-full');
      toast.classList.add('translate-x-0');
    }, 100);
    
    // Auto-remover ap√≥s 8 segundos
    setTimeout(() => {
      toast.classList.remove('translate-x-0');
      toast.classList.add('translate-x-full');
      setTimeout(() => {
        if (toast.parentElement) {
          toast.remove();
        }
      }, 500);
    }, 8000);
  }

  // Formul√°rio principal
  document.getElementById('contactForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = {
      nome: formData.get('nome'),
      email: formData.get('email'),
      telefone: formData.get('telefone'),
      empresa: formData.get('empresa'),
      cargo: formData.get('cargo'),
      mensagem: formData.get('mensagem') || '',
      timestamp: new Date().toISOString(),
      source: 'klonatec-website'
    };
    
    // Mostrar loading no bot√£o
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    submitBtn.innerHTML = '‚è≥ Salvando...';
    submitBtn.disabled = true;
    
    try {
      // Configura√ß√£o do Supabase
      const SUPABASE_URL = 'https://rvbqybwpgplgnwgrqcxy.supabase.co';
      const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ2YnF5YndwZ3BsZ253Z3JxY3h5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4OTA4MDgsImV4cCI6MjA3MTQ2NjgwOH0.W_XCEBNnC6MqxN9vVTQJr8w7XrRKnBAIje-gxkW2s4A';
      
      // Enviar para Supabase
      const response = await fetch(`${SUPABASE_URL}/rest/v1/leads`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
          'apikey': SUPABASE_ANON_KEY,
          'Prefer': 'return=minimal'
        },
        body: JSON.stringify({
          nome: data.nome,
          email: data.email,
          telefone: data.telefone,
          empresa: data.empresa,
          cargo: data.cargo,
          mensagem: data.mensagem,
          source: data.source,
          timestamp_original: data.timestamp,
          data_processamento: new Date().toISOString(),
          tipo_lead: 'lead_basico',
          prioridade: 'media',
          segmento: 'nao_identificado',
          lead_score: 10,
          status: 'novo_lead',
          proximo_passo: 'Entraremos em contato em at√© 24h para uma an√°lise gratuita.',
          valor_estimado: 50000,
          probabilidade: 25,
          data_fechamento: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]
        })
      });
      
      console.log('Response status:', response.status);
      console.log('Response headers:', response.headers);
      
      if (response.ok) {
        // Tentar ler a resposta como JSON, mas se falhar, assumir sucesso
        try {
          const result = await response.json();
          console.log('Lead salvo com sucesso:', result);
        } catch (jsonError) {
          console.log('Resposta n√£o √© JSON, mas opera√ß√£o foi bem-sucedida');
        }
        
        // Mostrar mensagem personalizada de sucesso
        mostrarMensagemSucesso();
        this.reset();
      } else {
        // Tentar ler erro como texto primeiro
        let errorMessage = `Status: ${response.status}`;
        try {
          const errorText = await response.text();
          console.error('Erro na resposta:', response.status, errorText);
          errorMessage += ` - ${errorText}`;
        } catch (textError) {
          console.error('Erro ao ler resposta como texto:', textError);
        }
        alert('‚ùå Erro ao salvar no banco: ' + errorMessage);
      }
    } catch (error) {
      console.error('Erro de conex√£o:', error);
      alert('‚ùå Erro de conex√£o: ' + error.message);
    } finally {
      // Restaurar bot√£o
      submitBtn.innerHTML = originalText;
      submitBtn.disabled = false;
    }
  });
</script>
